На 4
Все ошибки должны быть обработаны.
Сборка должна проходить без ошибок и предупреждений. Используйте: -Wall - Werror.
Сборка должна быть описана в Makefile/CMakeLists/meson.build, чтобы прокси собиралась командой make/cmake/meson. Для cmake использовать cmake_minimum_required = максимум 3.28.
Должен поддерживаться HTTP 1.0. Прокси должен корректно информировать как клиента, так и сервер об используемой версии протокола. Поддержка HTTP 1.1 не обязательна, но будет плюсом (частичная поддержка). Реализовывать HTTPS точно не нужно.
Должны обрабатываться GET методы.  Реализация PUT, POST и DELETE методов будет плюсом.
Не должно быть холостых циклов, sleep, usleep и тп. Допускается использование стандартных примитивов синхронизации pthread, системных вызовов select и poll и вызовов асинхронного ввода-вывода.
Должен быть модуль логирования, чтобы можно было писать сообщения с разными уровнями и было понятно, что происходит.
Нагрузка на процессор должна быть минимальна (в разумных пределах), особенно в простое, когда нет клиентских подключений.
Должны корректно обрабатываться сигналы. При получении сигналов на завершение, прокси должна закрыть все соединения, очистить выделенную память, завершить все потоки и завершиться (graceful shutdown). По сообщениям прокси в stdout/логе должно быть понятно, что эти этапы произошли (например, сообщения: Received shutdown signal; All threads have finished; Proxy finished)
Поддержка любых механизмов авторизации на сайтах не обязательна.
Можно как самому реализовать парсер HTTP, так и использовать готовые библиотеки (например: https://github.com/h2o/picohttpparser).
Если будете использовать сторонние библиотеки, то нужно будет подробно рассказать зачем они нужны, какими функциями пользуетесь и описать их внутреннюю работу.
Допускается реализация прокси на C или C++. Если будет выбран C++, то запрещается писать в стиле C (без ООП, голые указатели и тп).
Все варианты задания предполагают параллельную обработку запросов, т.е. при тестировании необходимо продемонстрировать возможность открыть несколько клиентских сессий и показать, что ни одна из сессий не ждет завершения операции ни одной из других сессий.
Требуется поддержка перенаправлений/redirect (http коды, начинающиеся на 3). Прокси сама должна получить все данные и передать клиенту.
Бинарник прокси должен принимать CLI флаги для удобства запуска и конфигурации (подходит getopt из стандартной библиотеки). Нужны следующие флаги: 
--port -  порт, на котором слушает прокси. По умолчанию 8080
--max-client-threads - максимальное кол-во работающих потоков (размер пула клиентских подключений).  По умолчанию 4
--help - вывод сообщения о том как запускать прокси, возможных флагах и их описания
Прокси не должна иметь ограничений по количеству клиентских сессий, кроме количества дескрипторов открытых файлов. 
Требуется наглядно показать архитектуру прокси. Это должны быть схемы/рисунки прокси и её модулей, то как они работают и взаимодействуют друг с другом.

На 5
Всё, что на 4
Кэш выглядит как мапа URL -> content
Желательно реализовывать работу с клиентскими соединениями  с помощью пулов. 
При наличии пула надо уметь поддерживать больше сессий, чем имеется потоков в пуле. 
Если пула нет, реализация имеет право задерживать входящие соединения при невозможности создать новый поток.
Допускается создание двух потоков на каждое клиентское соединение: «клиентский» поток обрабатывает соединение с клиентом, «серверный» – с сервером. В случае пула потоков, допускается разделение пула на два, серверных и клиентских потоков, исполняющих разный код.
Не должно происходить одинаковых запросов по URL одновременно. Т.е. если несколько клиентов одновременно идут по одному адресу (работают с одной записью кэша), то должен быть совершен только один веб запрос на сервер. Остальные клиенты должны ждать появления данных в кэше и при появлении части данных возвращать их клиенту. Нельзя ждать пока вся запись появиться в кэше.
Прокси должен корректно обрабатывать сброс клиентских сессий. В том числе, в случае, когда две или более сессий работали с одной записью кэша, после сброса одной из них, остальные сессии должны корректно продолжить докачку ресурса.
При передаче клиенту полной записи кэша, серверный поток можно не запускать. 
Кэш должен инвалидироваться. Спустя некоторое время (например, 5 секунд) с момента как все данные попали в кэш они должны считаться инвалидированными. При запросе по инвалидированному URL нужно будет выполнять веб запрос заново.
Кэш должен уметь продолжать работать после заполнения текущего максимума. Нужно или аллоцировать на лету еще один сегмент (когда размер кэша еще не достиг максимума), или реализовать логику для удаления ненужные записи. Для определения ненужных записей нужно реализовать алгоритм, например, LRU, SLRU, LFU, Clock и тп. В любом случае, аллокация или GC должны быть в отдельном потоке, и не должны мешать работе прокси.
Если сделаны методы PUT, POST и DELETE методы, то их кэшировать не нужно.
Кэшировать нужно только ответы с кодами HTTP 200. Все остальные ответы передавать без изменений и не кэшировать.
Кэшировать нужно все ресурсы (как текстовые, так и бинарные). Обязательно сохранение MIME метки ресурса.
Кэш хранится в памяти и может полностью теряться при перезапуске прокси. Персистентный кэш будет плюсом, но не обязателен.
Обработка полей заголовка, управляющих кэшированием, таких, как Last-modified, Pragma no-cache, Cache-Control и др., не обязательна.
Если запрашивается файл больше вместимости кэша, допускается ожидание его расширения (если возможно), либо (в случае превышения максимального размера кэша) отмена запроса с логированием ошибки.
Дополнительные CLI флаги:
--cache-initial-size - начальный размер кэша.  По умолчанию 1Мб
--cache-max-size - максимальный размер кэша.  По умолчанию 10Мб
--cache-ttl - время жизни кэш записи. По умолчанию 5с.
В случае с редиректами (см. п. 14 на 4) прокси сама должна получить все данные и сохранить их в кэш по первоначальному URL.
Тесты для прокси
	https://github.com/borodun/os-proxy-tests
Сайты HTTP 1.0
http://xcal1.vodafone.co.uk/ - есть файлы разных размеров для проверки производительности.
http://www.nuonsoft.com/blog/ - блог
http://weather.nsu.ru/ - погода НГУ
http://gramota.ru/ - словарь, есть редирект
http://parallels.nsu.ru/WackoWiki/KursOperacionnyeSistemy/PraktikumPosixThreads/ — база
http://www.realtimerendering.com/blog/ - блог
http://www.gutenberg.org/ - библиотека. Открывать книги нужно в формате Plain Text UTF-8. Тогда будет большая страница, можно будет проверить производительность. К примеру, Война и мир http://www.gutenberg.org/ebooks/2600 (https://www.gutenberg.org/ebooks/2600.txt.utf-8)
http://68k.news/ - гугл новости но в http 1.0


Еще есть мемные древние сайты
http://rinkworks.com/ - сбор игр?
http://ascii.textfiles.com/ - какой-то блог
http://theoldnet.com/ - зеркало wayback machine
http://www.midwinter.com/ - что-то про babylon 5


Есть еще видео с сайта кремля:
http://static.kremlin.ru/media/events/video/ru/video_high/LJmJ5nrjhyCfVNDigS1CHdlmaG15G8cR.mp4
http://kremlin.ru/ — много растровых изображений

